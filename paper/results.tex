\section{Results}
\label{sec:results}

We organize the presentation of our findings by topic, including how users
\emph{perceive} (\Cref{sec:perception}), \emph{manage} (\Cref{sec:manage}),
and \emph{wish to improve} (\Cref{sec:improve}) onion services.  We interleave the
results from our online survey with our interviews, focusing primarily on our
survey data but bringing up anecdotes and findings from our interviews as
appropriate.

\subsection{User perceptions of onion services}
\label{sec:perception}

\subsubsection{Mental models of Onion Services}
While the work of Tor developers is often held in high esteem, the content that
is hosted on onion services is perceived very differently.  Many of our participants were not able to define what an onion services were, such as one participant who sought clarification: \textquote[P03]{So
it's like the Hidden Wiki and stuff like that, where you can buy drugs and\dots
or supposedly.}

We asked our interview participants to draw sketches of onion services and the Tor network.\footnote{All sketches are available online at
\url{https://nymity.ch/onion-services/mental-models/}.}  All participants drew a
sketch of the Tor network but not all drew onion services because they had not
experienced them. \mc{how many were in each category?}  Interestingly, all participants understood that key to the
Tor network's anonymity is the bouncing of network traffic across several
relays, as evidenced by \Cref{fig:tor-sketch}, drawn by a participant with no
technical background.\footnote{However, the sketch got two details wrong: the
number of hops in a Tor circuit is three, and the circuit's forward and reverse
path are identical.} Analogously, most of our participants understood that
network traffic does not leave the Tor network when connecting to onion
services.  \Cref{fig:os-sketch} illustrates an example, again drawn by a
non-technical participant.  The last hop in the circuit is an onion, correctly
suggesting that network traffic does not leave the Tor network, albeit the
number of hops is incorrect.

\begin{figure}[t]
    \centering

    \begin{subfigure}[t]{\linewidth}
        \centering
        \includegraphics[width=0.8\linewidth]{figures/tor-sketch.jpg}
        \subcaption{A non-technical interview subject's (P08) sketch of how they
        believe the Tor network works.  The participant correctly understands
        the concept of bouncing network traffic over several hops.}
        \label{fig:tor-sketch}
    \end{subfigure}

    \begin{subfigure}[t]{\linewidth}
        \centering
        \includegraphics[width=0.8\linewidth]{figures/os-sketch.jpg}
        \subcaption{A non-technical interview subject's (P13) sketch of their
        mental model of an onion service.  Instead of a web site, the final hop
        is another Tor hop.}
        \label{fig:os-sketch}
    \end{subfigure}

    \caption{Sketches of two different, non-technical interview participants of
    how the Tor network works (top) and how onion services work (bottom).}
\end{figure}

Some of our interviewees did not distinguish disguising their \textsc{ip}
address from disguising their real-world identity and instead used the umbrella
term of ``anonymity'' to refer to both concepts.  This conflation of concepts
paints an incomplete picture of the security and privacy guarantees that the Tor
network provides, further illustrated by one participant's question:
\textquote[P07]{What's the point of going to Facebook using onion services when
their business model is still about collecting your data?}

There is merit in using Facebook's onion service.  While the company indeed
knows who is logging in, it does not know Tor users' \textsc{ip} address (and
hence location) or operating system.  On top of that, onion services provide
end-to-end security and self-authenticating names.  Syverson and Boyce took a
step back and looked at how onion services can improve website
authentication~\cite{Syverson2015a}.  These benefits are difficult to convey to
non-technical users, and even experts sometimes advocate an ``all or nothing''
approach to online anonymity, overlooking important nuances.
\subsubsection{Onion Services Do Not Make Users Feel Safer}
In our survey, we asked how safe our
respondents feel when using Tor Browser and onion services, respectively.
\Cref{fig:perceived-security} shows the results.  
86\% of our survey respondents feel at least somewhat safe using Tor Brower as compared to just over two thirds (67\%) of users of onion services.

\begin{figure}[t]
    \centering
    \input{figures/perceived-security.tex}
    \caption{The level of safety our respondents perceive when using Tor
    Browser (\textsc{tb}) and onion services (\textsc{os}s).}
    \label{fig:perceived-security}
\end{figure}

Our survey responses indicated that  non-experts lack the ability to evaluate (or even understand) the
Tor network's design which is why they defer to expert opinion, their gut
feeling, or the trust they place in Tor developers.  With respect to onion
services, the majority of survey respondents expressed that the added security and anonymity makes
them feel safe.  Another factor contributing to the perceived security is that
advertising companies are nowhere near as present on onion services as they are
on the web.  Orthogonal to the technology, many participants voiced concern
about illegal and questionable content on onion services, described by some as a
``Wild West.'' Phishing sites, honeypots, and compromised onion sites further
contribute to this perception.

\subsubsection{Onion Services Used For Purposes Other Than Web Browsing}
In the survey we asked about how often our respondents browse onion
services.  The usage frequency is almost uniformly distributed among our survey
respondents; 24\% use onion sites less than once a month, 22\% use them about
monthly, 25\% weekly, and 23\% daily.  The remaining 6\% has never used an onion
service before.

The majority of our respondents (61.8\%) have used onion services for purposes
other than web browsing before.  Several protocols, such as the chat application
Ricochet~\cite{ricochet} and the file sharing application
OnionShare~\cite{onionshare}, were purpose-built on top of onion services while
existing \textsc{tcp}-based tools, such as \textsc{ssh}, can transparently use
onion addresses instead of traditional \textsc{ip} addresses.  Almost one third
(29.7\%) of our participants use onion services for non-browsing activities at
least once a week.

The majority of our participants in the survey used onion services
because of the additional anonymity (70\%) and the additional security (61\%) (see \Cref{fig:onion-usage}).
For 46\% of the survey respondents, it was the only way to access content they enjoy, making the use of
onion services a necessity.  27\% of our survey respondents wanted to learn more about
the ``Dark Web'' and set out to satisfy their curiosity while 19\% occasionally
stumbled upon links to onion services in their day-to-day browsing activity.
Respondents who selected ``Other'' gave a variety of reasons, the most
predominant being the ability to set up a \textsc{tcp} service behind a
\textsc{nat} device.  That makes it possible to expose an \textsc{ssh} server in
a home network that has neither a permanent \textsc{ip} address nor port
forwarding.  Others use onion services to reduce the load on exit relays, to do
technical research, and to access sites that are otherwise unavailable.

\begin{figure}[t]
    \centering
    \input{figures/onion-usage.tex}
    \caption{Our respondents' (multiple choice) reasons for using onion
    services.}
    \label{fig:onion-usage}
\end{figure}



An unrelated, yet hardly unexpected, source of confusion is the domain format of
onion services.  Some users have come to believe that the seemingly-random
characters in onion domains are the reason why onion services are anonymous:

\begin{displayquote}[Survey respondent]
\ldots [The] Onion Services stay anonymous through changing their domain, and I
feel that there is a possibility of decreased anonymity with a constant domain
name.
\end{displayquote}

Accordingly, these users also believe that vanity domains are ``less anonymous''
because part of their domains is clearly not random.  A survey participant
further wrote: \textquote{I understand vanity onion domains are a sign of the
weakness of the hash algorithm used by the Tor network.}  An unrelated yet
equally incorrect opinion was voiced by a different survey respondent:
\textquote{These people who created their onion name using scallion or other
tools should notice that other people can make same private key.}

A question block on onion service operation inquired about the motivation for
running an onion service and what sort of issues operators encounter in the
process.  40\% of our respondents once set up an onion service.  Among the
respondents who never have, 31\% have considered doing so while 30\% have never
considered it.  Interestingly, 79\% of operators have run an onion service for
private use while 53\% have run them for the public.

\Cref{fig:onion-operation-reasons} gives an overview of the reasons our
respondents have for running onion services.  Interestingly, the extra security
properties outweigh the anonymity properties of onion services.  Another popular
motivation is \textsc{nat} traversal---many respondents noted that onion
services allow them to expose a \textsc{tcp} service in their home network
despite being behind a \textsc{nat} device.  Finally, some people run onion
services indirectly because third-party tools such as
OnionShare~\cite{onionshare} or Ricochet~\cite{ricochet} are built on top of
them.  A survey respondent gave the following reason for running onion services:
\textquote{We use it for delivering updates to our router to customers securely
and without leaking metadata.}

\begin{figure}[t]
    \centering
    \input{figures/onion-operation-reasons.tex}
    \caption{The (multiple-choice) reasons our respondents have for running
    onion services.}
    \label{fig:onion-operation-reasons}
\end{figure}

\subsection{Onion service discovery \& management}
\label{sec:manage}

Recall that a freshly set up onion service is private by default, leaving it up
to its operator to disseminate the domain.  Established search engines such as
Google are therefore inadequate to find content on onion services.  We wanted to
find out how our respondents discover onion services.
\Cref{fig:onion-discovery} illustrates the results.  The three most popular ways
of discovering new onion sites, all approximating 50\%, are \first~social
networking sites such as Twitter and Reddit, \second~the list of search engines
such as Ahmia,\footnote{Ahmia.fi is an onion site search engine that crawls
user-submitted onion domains.  It publishes the list of all indexed onion
services at \url{https://ahmia.fi/onions/}.} and \third~randomly encountering
links when browsing the web.

While significantly less popular, discovering onion domains through friends and
family has the advantage that domains come from a trusted source---an aspect
that mattered to some of our survey and interview participants.  Finally, a mere
4\% indicated that they are not interested in learning about new onion services.
Respondents who selected ``Other'' predominantly brought up
independently-maintained onion domain aggregators.  A noteworthy example is the
Hidden Wiki, a community-curated and frequently-forked wiki that contains
categorized links to onion services.

\begin{figure}[t]
    \centering
    \input{figures/onion-discovery.tex}
    \caption{Our respondents' (multiple choice) methods of discovering onion
    services.}
    \label{fig:onion-discovery}
\end{figure}

The next question in our survey asked if our respondents are satisfied with the
way they discover onion services.  60\% selected ``Yes'' while 40\% selected
``No.'' Some respondents who selected ``Yes'' brought up that they have no
interest in learning about new onion services, in part because they only use a
small set of onion services.  Among the people who are not satisfied, the most
prominent complaint was about link rot on aggregators.  There is significant
churn among onion sites, and our respondents were frustrated that aggregators
are typically not curated and therefore link to numerous dead domains.  The lack
of curation also leads to these aggregators' containing the occasional scam and
phishing site.  The difficulty of telling apart two given onion domain names
exacerbates this issue for users.  Another common wish for aggregators was for
them to be more verbose in their description of onion sites.  In particular,
some respondents want to avoid illegal and pornographic content, which is often
difficult if the description is vague and the onion domain reveals nothing about
its content.  Many respondents were not aware of search engines such as Ahmia.
Among those that were, many were dissatisfied with both the search results and
the number of indexed onion sites.  Unsurprisingly, a ``Google for onion sites''
was a frequent wish.

Many respondents expressed frustration about the difficulty of finding out if
example.com has a corresponding onion service.  A common wish was to have
example.com list its onion service prominently in a footer.  Ironically, some
respondents were surprised that torproject.org has a corresponding onion
site---they could not find it on the web site.

Conventional domains are designed to be easy to remember and recognize.  But how
do users handle randomly-generated onion domains?  Our survey
\hyperref[q3_7]{question 3.7} sought an answer, and the results are illustrated
in \Cref{fig:onion-domain-mgmt}.

\begin{figure}[t]
    \centering
    \input{figures/onion-domain-mgmt.tex}
    \caption{The strategies that our respondents use to handle onion domains.
    More than half use bookmarks inside of Tor Browser and a quarter thinks that
    there is no good solution.}
    \label{fig:onion-domain-mgmt}
\end{figure}

Most respondents use Tor Browser's bookmarks to save onion domains.  While
convenient, it leaves a trace of (presumably) visited sites on somebody's
computer.  One of Tor Browser's security requirements is ``disk avoidance,''
\ie, the browser must not write anything to disk that would reveal the user's
browsing history~\cite[\S~2.1]{Perry2017a}.  Bookmarking links is a violation of
this security requirement albeit requested by the user.  Many of our respondents
were aware of this issue, and about a dozen respondents who selected ``Other''
stated that they store onion domains in an encrypted manner---either in a text
file or in their password manager.  Somewhat less popular is saving onion
domains in local text files (36\%), getting them from trusted web sites (34\%),
using search engines (18\%), memorizing domains (16\%), using some other
techniques (9\%), or employing pen and paper (8\%).  Notably, one quarter of our
respondents do not have a good solution to the problem.  Given the alarming
number of (possibly insecure) home-baked solutions, a Tor Browser extension that
solves this problem seems warranted.

Of the respondents who memorize onion domains, we found that most respondents
memorize either one onion domain (15\% of total respondents) or four onion
domains (11\%); significantly fewer respondents memorize two domains (5\%),
three domains (4\%), and more than four domains (1\%).  As mentioned above,
bookmarking onion domains leaves a trace, and about 28\% of respondents said
they memorize onion domains to prevent this digital trace.  On the other hand,
more respondents memorize domains \first~to allow them to open the site more
quickly (51\%), \second~to ensure that they are visiting the correct site and
not a phishing site (44\%), and \third~automatically start to memorize domains
because of typing it many times (60\%).

Questions \hyperref[q3_12]{3.12} to \hyperref[q3_15]{3.15} asked respondents
about whether or not they memorize vanity domains---specifically
facebookcorewwwi.onion---and how difficult they find it to memorize onion
domains of differing levels of vanity.  59\% of respondents replied that
facebookcorewwwi.onion is among the sites that they have memorized.  This is
because it is ``easy to memorize'' and ``after seeing [it] many times, I
automatically start to memorize it.''  When asked about different levels of
vanity domains, the respondents expressed differing levels of ease for
memorizing them; these results are shown in \Cref{fig:memorize-domains}.
\textsc{Url}s such as expyuzz4wqqyqhjn.onion and torproz4wqqyqhjn.onion are
harder for respondents to remember because they mention that ``numbers make the
names harder to remember.''  Other respondents stated that domains are easier to
remember when they can be pronounced.  One respondent described it saying
``phonetic pronunciation plays a large part in how I remember onions.'' Many
other respondents stated that onion domains that are supported by a mnemonic are
also easier to remember.  

\begin{figure}[t]
    \centering
    \input{figures/onion-memorize-difficulty.tex}
    \caption{The difficulty our respondents would expect to face when trying to
    memorize four onion domains.}
    \label{fig:memorize-domains}
\end{figure}

The next question in our survey asked if our respondents expect the
next-generation domain format to change their browsing habits.  Interestingly,
only 17\% expect their browsing habits to change while 83\% do not.  Among the
respondents who selected ``Yes,'' many expressed that they memorize a small
number of onion domains (such as Facebook's), which will no longer be possible.
People who selected ``No'' mostly brought up that they treat onion domains as
opaque identifiers and handle via tools such as bookmarks.  We conclude that the
current state is dire, yet not expected to worsen with the new domain format.

\Cref{fig:onion-operation-concerns} illustrates the concerns that onion service
operators experience.  We consider three attacks; \first~somebody setting up a
phishing site for the operator's site, \second~a denial-of-service attack, and
\third~a deanonymization attack.  More than half of our respondents are at least
somewhat concerned about all of these attacks.  Almost 40\% claim to be
extremely concerned about somebody deanonymizing their onion service.  Indeed,
many respondents lamented the difficulty of protecting onion services from
application-layer deanonymization attacks.  Matic \ea\ demonstrated some of
these issues in 2015~\cite{Matic2015a}.

\begin{figure}[t]
    \centering
    \input{figures/onion-operation-concerns.tex}
    \caption{The level of concern onion service operators have with respect to a
    phishing clone of their service, denial-of-service attacks, and
    deanonymization.}
    \label{fig:onion-operation-concerns}
\end{figure}

We asked our respondents if they ever thought about the authenticity of an onion
site.  The majority of our respondents (80\%) did while 20\% did not.  Clearly,
there is a need for verification, but how does one verify that an onion service
is authentic?  \Cref{fig:determining-legitimacy} gives an overview of the
strategies that our respondents employ.  More than half either consult trusted
sources (\eg, friends or another, trusted web site) or use bookmarks when
revisiting onion services.  Many respondents also verify the domain in the
browser's address bar (46\%), check if the corresponding web site has a link to
its onion site (41\%), or hope that the onion service has an \textsc{https}
certificate (36\%).\footnote{DigiCert is issuing \textsc{ev} certificates for
onion sites~\cite{DigiCert2015a}, but adoption has been slow---presumably in part
because \textsc{ev} certificates require the \textsc{ca} to verify the
applicant's identity and they are not free.}  Alarmingly, almost 30\% of
respondents stated that they sometimes cannot tell the difference between an
authentic service and an impersonation, and 11\% never check a service's
legitimacy in the first place.  People who selected ``Other'' provided a wide
variety of ad-hoc phishing protections, some of which are clearly misguided,
further highlighting the importance of this issue.

\begin{figure}[t]
    \centering
    \input{figures/determining-legitimacy.tex}
    \caption{How our respondents determine an onion service's legitimacy.}
    \label{fig:determining-legitimacy}
\end{figure}

The majority of our respondents appreciate vanity domains because they are easy
to remember (64\%) and easy to recognize (64\%), and they provide a unique
``branding'' (34\%).  Some respondents indicate that a vanity prefix---like a
traditional domain---informs about an onion service's content, letting visitors
know what to expect and thus preventing unpleasant surprises.  Only 8\% dislike
vanity onion domains, and 15\% do not have an opinion.  Interestingly, some
respondents consider vanity domains economically unfair because wealthy entities
can afford to generate longer prefixes.  Several respondents also voiced their
concern that vanity domains create a false sense of security and facilitate
phishing attacks.

In a separate question, we inquired how many characters our respondents verify in
onion domains.  43\% verify thirteen to sixteen digits, \ie, (almost) the full
domain, while 46\% verify up to nine digits, which is within the realm of brute
force attacks.

\subsection{Onion service issues \& improvements}
\label{sec:improve}

\hyperref[q3_17]{Question 3.17} asked respondents if popular web sites such as
YouTube, Twitter, or Amazon offered onion sites in parallel to their normal web
sites, would they prefer the normal site or the onion site. 20.21\% of
respondents said they would always prefer the normal web site, 49.07\% said they
would always prefer the onion site, and 30.72\% chose ``Other.'' Many of those
who selected ``Other'' had performance concerns.  One user stated, ``I would
always prefer the onion site, but for video sites like YouTube I would likely
often use the normal site to be able to get a higher quality stream due to
higher bandwidth.'' Others mentioned not wanting to log in to onion sites
because they believe it defeats the purpose---a fallacy that we discussed in
\Cref{sec:perception}.  In explaining their responses, respondents mentioned
that they like the privacy that onion sites provide, and they hope that they
wouldn't have to deal with \textsc{captcha}s and discrimination against Tor
users.


We also asked respondents if Tor Browser could automatically redirect them from
a normal web site to its corresponding onion site (\eg, from facebook.com to
facebookcorewwwi.onion), would they use that feature. Respondents were largely
in favor of this: 15.61\% said they would never use that feature, 34.91\% said
they would use it for some sites, 37.78\% said they would always use it, and
11.70\% chose ``Other.'' Respondents liked the convenience of being redirected.
The naysayers were quite passionate, though, and they were concerned about
potential security issues. One respondent said,
\textquote{What's to stop them from man in the middle'ing me, either by choice,
at the behest of some nefarious entity, or after being hacked?}
We conclude that there is clear interest in such an ``upgrade'' feature provided
that it is carefully designed and offers users an option to control the process
on a per-site basis.

Phishing remains an issue despite onion services' extra anonymity and security
properties.  Past work has documented phishing onion sites that transparently
rewrote Bitcoin addresses to hijack Bitcoin
transactions~\cite{Winter2016a,Nurmi2015a,Monteiro2016a}.  Key to this attack is
the difficulty of telling apart an authentic onion domain from an impersonation.
For conventional domains we rely on (\textsc{ev}) certificates, browser
protections, search results, and long-lived reputation, but none of these
methods have matured for onion services.  Does the nature of onion services
facilitate phishing attacks?  If so, what can we do to mitigate the issue?

Originally meant to provide ``branding'' for an onion service, vanity onion
domains also play a role in the context of phishing.  There is concern that the
short and recognizable prefixes tempt users to only verify the prefix and ignore
subsequent characters.  One respondent reported that \textquote{I only memorize
the first part of the domain.} while another wrote:

\begin{displayquote}[Survey respondent]
If there isn't some cognizable word at the start, it'll be more difficult for me
to determine if I'm going to the correct domain or a scam. I may end up going to
less .onion sites as a result.
\end{displayquote}

Focusing only on the vanity part of a domain allows attackers to create an
impersonation domain that features the original's prefix but differs in
subsequent characters.  Nurmi~\cite{Nurmi2015a} and
Monteiro~\cite{Monteiro2016a} have both documented such an attack, but its
effectiveness is not known.
