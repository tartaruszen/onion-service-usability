\section{Results}
\label{sec:results}

We organize the presentation of our findings by topic, starting with Tor
Browser, and then onion service-specific topics such as service discovery and
the operation of onion services.  We interweave the results from our online
survey and from our interviews, focusing primarily on our survey data but
bringing up anecdotes and findings from our interviews as appropriate.

\subsection{The Tor Project}

Our work focuses on the usability of onion services, but our interviews and parts
of our survey data also provided some insight into how our respondents perceive The Tor
Project and its work.  We summarize these findings here.

\subsubsection{Documentation and localization}

The Tor Project's documentation covers an array of topics including
installation, the use on Android, the operation of Tor relays, several
\textsc{faq}s, and a wiki.  Having worked with this documentation, some of our
interview and survey participants lamented its scope:

\begin{displayquote}[P14]
Tor does a good job on their web site of telling you to modify your
[configuration] file, and then getting the onion set up.  But it's just very
basic.  I have to go [to] other people's blog post to find out.
\end{displayquote}

Another participant struggled with the lack of localization.  While Tor
Browser's user interface is available in Spanish, the documentation is not:

\begin{displayquote}[P11]
Think more [about] the Spanish community\dots because in my case I'm trying to
train people to use Tor but I work in the indigenous communities and there are
some things that [are] hard for me to explain in terms of how you use Tor\dots
\end{displayquote}

\subsubsection{Public perception}

The Tor Project goes to great lengths to minimize the trust its users have to
place in it by publishing design documents and source code and coordinating
development in public.  Laypeople however lack the skill while experts typically
lack the time to audit source code, which is why trust and reputation matter.
The Tor Project enjoyed a lot of trust among our interview participants, which,
admittedly, comes as no surprise because we recruited our interviewees from
Tor-friendly social media and an Internet freedom event.

\begin{displayquote}[P08]
Because, you guys\dots have the sort of\dots not a monopoly on trust, but you
have like a really great brand name when it comes to this stuff\dots
\end{displayquote}

While the work of Tor developers is often held in high esteem, the content that
is hosted on onion services is perceived very differently.  Upon being told what
an onion service is, one participant sought clarification:

\begin{displayquote}[P03]
So it's like the Hidden Wiki and stuff like that, where you can buy drugs
and\dots or supposedly.
\end{displayquote}

\hyperref[q6_3]{Questions 6.3} and \hyperref[q6_5]{6.5} asked how safe our
respondents feel when using Tor Browser and onion services, respectively.
\Cref{fig:perceived-security} shows the results.  The use of Tor Browser makes
86\% of our respondents feel at least somewhat safe.  The same is true for 67\%
when using onion services---clearly not as many as for Tor Browser.

\begin{figure}[t]
    \centering
    \input{figures/perceived-security.tex}
    \caption{The level of safety our respondents perceive when using Tor
    Browser (\textsc{tb}) and onion services (\textsc{os}s).}
    \label{fig:perceived-security}
\end{figure}

Asked about why our respondents feel that way about Tor Browser, our results
reveal that non-experts lack the ability to evaluate (or even understand) Tor's
design which is why they defer to expert opinion, their gut feeling, or the
trust they place in Tor developers.  The Tor Project is perceived to take
security and privacy more seriously than any other browser vendor, which is
appreciated among our respondents.  Most of our respondents' criticism focused
not on Tor Browser but on the underlying Firefox code base.  Many participants
were unhappy with Firefox's exploit mitigation techniques, the lack of
sandboxing, and the complex code base.  Chrome was sometimes brought up as the
gold standard for browser security.\footnote{Note that we conducted our survey
before Mozilla released Firefox Quantum on November 14, 2017, which brought
substantial improvements in both security and usability.}  Malicious exit relays
were a concern for a handful of participants while another couple of
participants were concerned that their use of Tor makes them stick out and turns 
them into targets for government agencies.  Tor Browser comes with modules that
disguise the fact that one is using Tor, but a standard Tor connection does not
use these modules, making it easy to identify for Internet service
providers~\cite{pluggable}.  One interview participant worried:

\begin{displayquote}[P03]
I guess you could put yourself on some kind of watch lists, that you are a
person of interest, just because you're using [Tor].
\end{displayquote}

Some survey respondents were not sure if their Tor setup works properly---a
common theme that we also noticed in our interviews: Non-technical users desire
visual feedback confirming that their network traffic comes out ``somewhere
else,'' a point that we will elaborate on in \Cref{sec:under-the-hood}.

With respect to onion services, the majority expressed that the added security
and anonymity makes them feel safe.  Another factor contributing to the
perceived security is that onion services make use of far fewer advertising
companies.  Orthogonal to the technology, many participants voiced concern about
illegal and questionable content on onion services, described by some as a
``Wild West.''  Phishing sites, honeypots, and compromised onion sites further
contribute to this perception.

\subsection{Tor Browser usage}

Our survey started with two questions about how often our respondents use Tor
Browser.  The results are illustrated in \Cref{fig:tor-usage}.  Almost half of
our participants use Tor Browser either daily or even as their main browser.
Both Gallagher \ea~\cite[\S~4.3.2]{Gallagher2017a} and our interview data
suggests that non-experts frequently use Tor for specific tasks but do not embed
it in their daily workflow:

\begin{displayquote}[P07]
Right now, I use it very little, just because I don't have a lot of reasons to,
because of the fact that I have other security practices that do the trick for
the kind of work that I do.
\end{displayquote}

\begin{figure}[t]
    \centering
    \input{figures/tor-usage.tex}
    \caption{The usage frequency of Tor Browser among our respondents, almost
    half of whom use Tor Browser either daily or as their main browser.}
    \label{fig:tor-usage}
\end{figure}

\Cref{fig:tor-threats} illustrates what entities our respondents seek to protect
themselves from when using Tor Browser.  The majority want to protect themselves
from ad companies, governments, and most prominently, their \textsc{isp}s.
More tangible entities such as family, employers, and schools are less prevalent.
People who selected ``Other'' gave a variety of responses.  A number of respondents
specifically pointed out Google and Facebook.  \textsc{isp}s, backbone
\textsc{isp}s, and web sites were another common theme.  A number of respondents
are struggling with personal threats that include identity theft, targeted
harassment, and stalking.  Research is another common theme: Several respondents
want to learn about a topic without revealing their interest in it.  Some
respondents use Tor for search engine optimization, computer security research,
and to research medical conditions.  Finally, Tor has use cases that do not
involve a threat actor.  Some respondents want IPv6 connectivity, evasion of
geographical content restrictions, and access to onion services.  One respondent
stated that they do not need anonymity themselves but use Tor to provide cover
traffic for ``people who need protection.''


\begin{figure}[t]
    \centering
    \input{figures/tor-threats.tex}
    \caption{The threat actors that our respondents seek to protect themselves
    from by using Tor Browser.}
    \label{fig:tor-threats}
\end{figure}

\subsubsection{Users enjoy a look ``under the hood''}
\label{sec:under-the-hood}

\begin{figure}[t]
    \centering
    \includegraphics[width=\linewidth]{figures/tor-button-screenshot.jpg}
    \caption{A click on the onion icon reveals the Tor relays that constitute
    the circuit that was used to fetch the current page.  As of January 2018,
    the user interface is subject to a redesign~\cite{trac24309}.}
    \label{fig:tor-button}
\end{figure}

By clicking on the onion icon in the top left corner of Tor Browser (see
\Cref{fig:tor-button}), one can see the circuit that is used for the current web
site.  Some of our interviewees appreciated this visual feedback:

\begin{displayquote}[P08]
I love how I can monitor the network through this little kind of bar that comes
up.
\end{displayquote}

Not satisfied with seeing only the current circuit, some participants wished it
were easier to learn what else is happening behind the scenes:

\begin{displayquote}[P02]
{[It]} would be nice to have some kind of application, something on that browser,
that gives you an impression of\dots what the Tor Browser's actually doing.
\end{displayquote}

Finding the right balance between what information to show and what to hide is
challenging in itself and only exacerbated by Tor's heterogeneous user base.
While technical users may appreciate a look ``under the hood,'' non-technical
users, who often use Tor as a tool to get a specific job done, can easily feel
bewildered and overwhelmed.  One aspect, however, in which more transparency could
benefit Tor's entire user base is when web sites do not load, as suggested by
one participant:

\begin{displayquote}[P05]
\dots maybe some sort of graphical representation of is the circuit still
being built, or is the circuit built, and the site isn't responding at all to
the third relay?
\end{displayquote}

\subsubsection{Quantifying anonymity is hard}

The degree of anonymity that protects a Tor user in a given situation depends on
a number of variables including her guard relay, intermediate autonomous systems
on the network path, and other people that are using Tor at the same time, just
to name a few.  Unlike the \textsc{jap} anonymity tool~\cite{jap}, Tor Browser
makes no attempt to display the degree of anonymity it believes it can provide.
Asked about how well Tor works for them, one of our participants explained:

\begin{displayquote}[P12]
In terms of the anonymity, you can't really tell\dots That's fairly opaque, so I
can't even tell how effective that's working, or whether it is\dots
\end{displayquote}

Quantifying anonymity in a real-world setting is complex, error-prone, and often
misleading.  What is more, Tor Browser does not have available all the data it
needs to quantify its user's anonymity---an ``anonymity meter'' may therefore
create more problems than it solves.

\subsubsection{\textsc{ui}, speed, and \textsc{captcha}s remain frustrating}

Perhaps the most prevalent usability issue is, still, browsing speed.  An
interviewee provided the following anecdote:

\begin{displayquote}[P01]
The speed of it is problematic; sometimes I have a path that allows me to watch
full \textsc{hd} YouTube videos, and the next time, five minutes later, I'm
barely getting kilobytes through.
\end{displayquote}

Occasionally, Tor is preceded by its reputation, preparing users for what to
expect, as another interview participant reported:

\begin{displayquote}[P03]
I didn't think it was as slow as people say it was. People said it would be a
much slower experience but\ldots a little bit slower, but it didn't matter for
the things that I was doing.
\end{displayquote}

In addition to the perceived slowness, several participants lamented the
old-fashioned user interface, describing Tor Browser's looks as ``it felt like
it was about five years outdated,'' ``it looked like I was in 1982,'' and ``I
think the colors look a bit old fashioned and in the former Soviet Union.'' To
our surprise, one participant expressed that the antiquated user interface also
evoked trust:

\begin{displayquote}[P02]
At the same time I thought\ldots it gave them a certain amount of credibility,
like they weren't building this for the looks, but they were building it for
functionality\ldots  At the same time, as I thought it was outdated in terms of
how it looked, I also thought it was sort of genuine in a way.
\end{displayquote}

Orthogonal to Tor's speed and user interface, the browsing experience
occasionally suffers.  Relying on naive, \textsc{ip} address-based metrics of
``maliciousness,'' some content delivery networks such as Cloudflare label Tor
exit relays as malicious which results in Tor users' having to solve (sometimes
multiple) \textsc{captcha}s before being granted access to a web site.  In 2016,
Khattak \ea documented the issue for a number of content
providers~\cite{Khattak2016a}.  Both survey and interview participants brought
up the topic and one person managed to depict the issue without the use of
profanity:

\begin{displayquote}[P06]
It is still sometimes challenging using some everyday services because of
\textsc{captcha}s and those things, but I also understand that's not so much to
do with Tor, but to do with the creators of those web sites.
\end{displayquote}

\subsubsection{Empowerment through security and privacy}

It comes as no surprise that our data reveals that the main benefit of Tor
Browser is the increase in privacy and security, brought up by practically all
of our interview participants.  One of our more technical interviewees (and
several of our survey respondents) further distinguished between security and
privacy.  Asked about if they feel safer when using Tor, they responded:

\begin{displayquote}[P06]
In a privacy sense, I do. In a security sense\ldots I don't assume that Tor is
protecting me from all of the vulnerabilities or exploits that I might
encounter\ldots
\end{displayquote}

Besides the obvious improvement in security and privacy, a defining aspect of
Tor is that it puts users back in control, or, as one of our participants
eloquently phrased it:

\begin{displayquote}[P02]
I feel like I'm more in control of my internet experience that way, I'm not sort
of like a will-less victim of what other people want to do with me, so I feel
I'm more empowered and have more agency when I use the Tor Browser.
\end{displayquote}

\subsection{Onion service usage}

We now move on to results specific to onion services, the focus of our online
survey.  The usage frequency of onion services is almost uniformly distributed
among our respondents; 24\% use onion sites less than once a month, 22\% use
them about monthly, 25\% weekly, and 23\% daily.  The remaining 6\% has never
used an onion service before.

The majority of our respondents (61.8\%) have used onion services for purposes
other than web browsing before.  Several protocols, such as the chat application
Ricochet~\cite{ricochet} and the file sharing application
OnionShare~\cite{onionshare}, were purpose-built on top of onion services while
existing \textsc{tcp}-based tools, such as \textsc{ssh}, can transparently use
onion addresses instead of traditional \textsc{ip} addresses.  Almost one third
(29.7\%) of our participants use onion services for non-browsing activities at
least once a week.

But why do Tor users browse onion services in the first place?
\Cref{fig:onion-usage} provides some insight.  The majority uses onion services
because of the additional anonymity (70\%) and the additional security (61\%).
For 46\% it is the only way to access content they enjoy, making the use of
onion services a necessity.  27\% of our respondents found themselves eager to
learn more about the ``Dark Web'' and set out to satisfy their curiosity while
19\% occasionally stumble upon links to onion services in their day-to-day
browsing activity.  Respondents who selected ``Other'' gave a variety of
reasons, the most predominant being the ability to set up a \textsc{tcp} service
behind a \textsc{nat} device.  That makes it possible to run an \textsc{ssh}
server in a home network that has neither a permanent \textsc{ip} address nor
port forwarding.  Others use onion services to reduce the load on exit relays,
to do technical research, and to access sites that are otherwise unavailable.

\begin{figure}[t]
    \centering
    \input{figures/onion-usage.tex}
    \caption{Our respondents' (multiple choice) reasons for using onion
    services.}
    \label{fig:onion-usage}
\end{figure}

\subsubsection{Mental models are often patchy}
\label{sec:mental-models}

Recall that we asked our interview participants to draw sketches of Tor and
onion services.\footnote{All sketches are available online at
\url{https://nymity.ch/onion-services/mental-models/}.}   Everybody drew a
sketch of Tor but some did not draw onion services because they had not
experienced them.  Interestingly, all participants understood that key to Tor's
anonymity is the bouncing of network traffic across several relays, as evidenced
by \Cref{fig:tor-sketch}, drawn by a participant with no technical
background.\footnote{However, the sketch got two details wrong: the number of
hops in a Tor circuit is three, and the circuit's forward and reverse path are
identical.} Analogously, most of our participants understood that network
traffic does not leave the Tor network when connecting to onion services.
\Cref{fig:os-sketch} illustrates an example, again drawn by a non-technical
participant.  The last hop in the circuit is an onion, correctly suggesting that
network traffic does not leave the Tor network.

\begin{figure}[t]
    \centering

    \begin{subfigure}[t]{\linewidth}
        \centering
        \includegraphics[width=0.8\linewidth]{figures/tor-sketch.jpg}
        \subcaption{A non-technical interview subject's (P08) sketch of how they
        believe Tor works.  The participant correctly understands the concept of
        bouncing network traffic over several hops.}
        \label{fig:tor-sketch}
    \end{subfigure}

    \begin{subfigure}[t]{\linewidth}
        \centering
        \includegraphics[width=0.8\linewidth]{figures/os-sketch.jpg}
        \subcaption{A technical interview subject's (P01) sketch of their mental
        model of an onion service.  Instead of a web site, the final hop is
        another Tor hop.}
        \label{fig:os-sketch}
    \end{subfigure}

    \caption{Sketches of two different, non-technical interview participants of
    how Tor works (top) and how onion services work (bottom).}
\end{figure}

Some of our interviewees did not distinguish disguising their \textsc{ip}
address from disguising their real-world identity and instead used the umbrella
term of ``anonymity'' to refer to both concepts.  This conflation of concepts
paints an incomplete picture of the security and privacy guarantees that Tor
provides, further illustrated by one participant's question:

\begin{displayquote}[P07]
What's the point of going to Facebook using onion services when their business
model is still about collecting your data?
\end{displayquote}

There is merit in using Facebook's onion service.  While the company indeed
knows who is logging in, it does not know Tor users' \textsc{ip} address (and
hence location) or operating system.  On top of that, onion services provide
end-to-end security and self-authenticating names.  These benefits are difficult
to convey to non-technical users, and even experts sometimes advocate an ``all or
nothing'' approach to online anonymity, overlooking important nuances.

An unrelated, yet hardly unexpected, flawed mental model is the domain format of
onion services.  Some users have come to believe that the seemingly-random
characters in onion domains are the reason why onion services are anonymous.
Accordingly, these users also believe that vanity domains are ``less anonymous''
because part of their domains is clearly not random.

\subsubsection{Makeshift solutions ease onion service discovery}

Recall that a freshly set up onion service is private by default, leaving it up
to its operator to disseminate the domain.  Established search engines such as
Google are therefore inadequate to find content on onion services.  We wanted to
find out how our respondents discover onion services.
\Cref{fig:onion-discovery} illustrates the results.  The three most popular ways
of discovering new onion sites, all approximating 50\%, are \first~social
networking sites such as Twitter and Reddit, \second~the list of search engines
such as Ahmia\footnote{Ahmia.fi is an onion site search engine that crawls
user-submitted onion domains.  It publishes the list of all indexed onion
services at \url{https://ahmia.fi/onions/}.}, and \third~randomly encountering
links when browsing the web.

While significantly less popular, discovering onion domains through friends and
family has the advantage that domains come from a trusted source---an aspect
that mattered to some of our survey and interview participants.  Finally, a mere
4\% indicated that they are not interested in learning about new onion services.

Respondents who selected ``Other'' predominantly brought up
independently-maintained lists of onion services and aggregators.  A noteworthy
example is the Hidden Wiki, a community-curated and frequently-forked wiki that
contains categorized links to onion services.

\begin{figure}[t]
    \centering
    \input{figures/onion-discovery.tex}
    \caption{Our respondents' (multiple choice) methods of discovering onion
    services.}
    \label{fig:onion-discovery}
\end{figure}

The next question in our survey asked if our respondents are satisfied with the
way they discover onion services.  60\% selected ``Yes'' while 40\% selected
``No.'' Some respondents who selected ``Yes'' brought up that they have no
interest in learning about new onion services, in part because they only use a
small set of onion services.  Among the people who are not satisfied, the most
prominent complaint was about broken links on onion site lists.  There is
non-trivial churn among onion sites, and our respondents were frustrated that
existing lists are typically not curated and link to numerous dead domains.  The
lack of curation also leads to these lists' containing the occasional scam and
phishing site.  The difficulty of telling apart two given onion domain names
exacerbates this issue for users.  Another common wish for aggregators was for
them to be more verbose in their description of onion sites.  In particular,
some respondents want to avoid illegal and pornographic content, which is often
difficult if the description is vague and the onion domain reveals nothing about
its content.  Many respondents were not aware of search engines such as Ahmia.
Among those that were, many were dissatisfied with both the search results and
the number of indexed onion sites.  Unsurprisingly, a ``Google for onion sites''
was a frequent wish.

Many respondents expressed frustration about the difficulty of finding out if
example.com has a corresponding onion service.  A common wish was to have
example.com list its onion service prominently in a footer.  Ironically, some
respondents were surprised that torproject.org has a corresponding onion
site---they could not find it on the web site.  Interestingly, some respondents
voiced frustration about various usability issues but mentioned in the same
sentence that this is an inherent trade-off of privacy technology, suggesting
that there is nothing that can be done about it.

\subsubsection{Onion domain management is problematic}

Conventional domains are designed to be easy to remember and recognize.  But how
do users handle randomly-generated onion domains?  Our survey
\hyperref[q3_7]{question 3.7} sought an answer, and the results are illustrated
in \Cref{fig:onion-domain-mgmt}.

\begin{figure}[t]
    \centering
    \input{figures/onion-domain-mgmt.tex}
    \caption{The strategies that our respondents use to handle onion domains.
    More than half use bookmarks inside of Tor Browser and a quarter thinks that
    there is no good solution.}
    \label{fig:onion-domain-mgmt}
\end{figure}

Most respondents use Tor Browser's bookmarks to save onion domains.  While
convenient, it leaves a trace of (presumably) visited sites on somebody's
computer.  One of Tor Browser's security requirements is ``disk avoidance,''
\ie, the browser must not write anything to disk that would reveal the user's
browsing history~\cite[\S~2.1]{Perry2017a}.  Bookmarking links is a violation of
this security requirement albeit requested by the user.  Many of our respondents
were aware of this issue, and about a dozen respondents who selected ``Other''
stated that they store onion domains in an encrypted manner---either in a text
file or in their password manager.  Somewhat less popular is saving onion
domains in local text files (36\%), getting them from trusted web sites (34\%),
using search engines (18\%), memorizing domains (16\%), using some other
techniques (9\%), or employing pen and paper (8\%).  Notably, one quarter of our
respondents do not have a good solution to the problem.  Given the alarming
number of (possibly insecure) home-baked solutions, a Tor Browser extension that
solves this problem may be warranted.

Of the respondents who memorize onion domains, we found that most respondents
memorize either one onion domain (15\% of total respondents) or four onion
domains (11\% of total respondents); significantly fewer respondents memorize
two domains (5\%), three domains (4\%), and more than four domains (1\%).  As
mentioned above, bookmarking onion domains leaves a trace, and about 28\% of
respondents said they memorize onion domains to prevent this digital trace.  On
the other hand, more respondents memorize domains \first to allow them to open
the site more quickly (51\%), \second to ensure that they are visiting the
correct site and not a phishing site (44\%), and \third automatically start to
memorize domains because of typing it many times (60\%).

Our survey also asked respondents about whether or not they memorize vanity
domains---specifically facebookcorewwwi.onion---and how difficult they find it
to memorize onion domains of differing levels of vanity.  59\% of respondents
replied that facebookcorewwwi.onion is among the sites that they have memorized.
This is because it is ``easy to memorize'' and ``after seeing [it] many times, I
automatically start to memorize it.''  When asked about different levels of
vanity domains, the respondents expressed differing levels of ease for 
memorizing them; these results are shown in \Cref{fig:memorize-domains}.
\textsc{url}s such as expyuzz4wqqyqhjn.onion and torproz4wqqyqhjn.onion are
harder for respondents to remember because they mention that ``numbers make the
names harder to remember.''  Other respondents stated that domains are easier to
remember when they can be pronounced.  One respondent described it saying
``phonetic pronunciation plays a large part in how I remember onions.'' Many
other respondents stated that onion domains that are supported by a mnemonic are
also easier to remember.  

\begin{figure}[t]
    \centering
    \input{figures/onion-memorize-difficulty.tex}
    \caption{The difficulty our respondents would expect to face when trying to
    memorize four onion domains.}
    \label{fig:memorize-domains}
\end{figure}

The next question in our survey asked if our respondents expect the
next-generation domain format to change their browsing habits.  Interestingly,
only 17\% expect their browsing habits to change while 83\% do not.  Among the
respondents who selected ``Yes,'' many expressed that they memorize a small
number of onion domains (such as Facebook's), which will no longer be possible.
People who selected ``No'' mostly brought up that they treat onion domains as
opaque identifiers and handle via tools such as bookmarks.  These results
suggest that the current state is dire, yet not expected to worsen with the new
domain format.

\subsubsection{Onion services as popular alternatives}

We asked respondents if popular web sites such as YouTube, Twitter, or Amazon
offered onion sites in parallel to their normal web sites, would they prefer the
normal site or the onion site. 20.21\% of respondents said they would always
prefer the normal web site, 49.07\% said they would always prefer the onion
site, and 30.72\% chose ``Other.'' Many of those who selected ``Other'' had
performance concerns.  One user stated, ``I would always prefer the onion site,
but for video sites like YouTube I would likely often use the normal site to be
able to get a higher quality stream due to higher bandwidth.'' Others mentioned
not wanting to log in to onion sites because they believe it defeats the
purpose, but this is not true (see \Cref{sec:mental-models}).  In explaining
their responses, respondents mentioned that they like the privacy that onion
sites provide, and they hope that they wouldn't have to deal with
\textsc{captcha}s and discrimination against Tor users.

We also asked respondents if Tor Browser could automatically redirect them from
a normal web site to its corresponding onion site (\eg, from facebook.com to
facebookcorewwwi.onion), would they use that feature. Respondents were largely
in favor of this: 15.61\% of respondents said they would never use that feature,
34.91\% said they would use it for some sites, 37.78\% said they would always
use it, and 11.70\% chose ``Other.'' Respondents liked the convenience of being
redirected.  The naysayers were quite passionate, though, and they were
concerned about potential security issues. One respondent said, 

\begin{displayquote}[Survey respondent]
I don't trust the Tor project enough to allow them to redirect me from clearnet
sites to onion sites.  What's to stop them from man in the middle'ing me, either
by choice, at the behest of some nefarious entity, or after being hacked? I
would only be inclined to trust it if it was based on some kind of immutable
blockchain thing like namecoin, and the Tor project did not act as some kind of
intermediary.
\end{displayquote}

We conclude that there is clear interest in such an ``upgrade'' feature provided
that it is carefully designed and offers users an option to control the process
on a per-site basis.

\subsubsection{Onion services have many use cases}

A question block on onion service operation inquired about the motivation for
running an onion service and what sort of issues operators encounter in the
process.  40\% of our respondents once set up an onion service.  Among the
respondents who never have, 31\% have considered doing so while 30\% have never
considered it.  Interestingly, 79\% of operators have run an onion service for
private use while 53\% have run them for the public.

\Cref{fig:onion-operation-reasons} gives an overview of the reasons our
respondents have for running onion services.  Interestingly, the extra security
properties outweigh the anonymity properties of onion services.  Another popular
motivation is \textsc{nat} traversal---many respondents noted that onion
services allow them to expose a \textsc{tcp} service in their home network
despite being behind a \textsc{nat} device.  Finally, some people run onion
services indirectly because third-party tools such as
OnionShare~\cite{onionshare} or Ricochet~\cite{ricochet} are built on top of
them.  A survey respondent gave the following reason for running onion services:

\begin{displayquote}[Survey respondent]
We use it for delivering updates to our router to customers securely and without
leaking metadata.
\end{displayquote}

\begin{figure}[t]
    \centering
    \input{figures/onion-operation-reasons.tex}
    \caption{The (multiple-choice) reasons our respondents have for running
    onion services.}
    \label{fig:onion-operation-reasons}
\end{figure}

\Cref{fig:onion-operation-concerns} illustrates the concerns that onion service
operators experience.  We consider three attacks; \first somebody setting up a
phishing site for the operator's site, \second a denial-of-service attack, and
\third a deanonymization attack.  More than half of our respondents are at least
somewhat concerned about all of these attacks.  Almost 40\% claim to be
extremely concerned about somebody deanonymizing their onion service.  Indeed,
many respondents lamented the difficulty of protecting onion services from
application-layer deanonymization attacks.  Matic \ea demonstrated some of these
issues in 2015~\cite{Matic2015a}.

\begin{figure}[t]
    \centering
    \input{figures/onion-operation-concerns.tex}
    \caption{The level of concern onion service operators have with respect to a
    phishing clone of their service, denial-of-service attacks, and
    deanonymization.}
    \label{fig:onion-operation-concerns}
\end{figure}

\subsubsection{Vanity domains are a double-edged sword}

Phishing remains an issue despite onion services' extra anonymity and security
properties.  Past work has documented phishing onion sites that transparently
rewrote Bitcoin addresses to hijack Bitcoin
transactions~\cite{Winter2016a,Nurmi2015a,Monteiro2016a}.  Key to this attack is
the difficulty of telling apart an authentic from an impersonation onion domain.
For conventional domains we rely on (\textsc{ev}) certificates, browser
protections, search results, and long-lived reputation, but none of these
methods has matured for onion services.  Does the nature of onion services
facilitate phishing attacks?  If so, what can we do to mitigate the issue?

We asked our respondents if they ever thought about the authenticity of an onion
site.  The majority of our respondents (80\%) did while 20\% did not.  Clearly,
there is a need for verification but how does one verify that an onion service
is authentic?  \Cref{fig:determining-legitimacy} gives an overview of the
strategies that our respondents employ.  More than half either consult trusted
sources (\eg, friends or another, trusted web site) or use bookmarks when
revisiting onion services.  Many respondents also verify the domain in the
browser's address bar (46\%), check if the corresponding web site has a link to
its onion site (41\%), or hope that the onion service has an \textsc{https}
certificate (36\%).\footnote{DigiCert is issuing \textsc{ev} certificates for
onion sites~\cite{DigiCert2015a} but adoption has been slow---presumably in part
because \textsc{ev} certificates require the \textsc{ca} to verify the
applicant's identity and they are not free.}  Alarmingly, almost 30\% of
respondents stated that they sometimes cannot tell the difference between an
authentic service and an impersonation, and 11\% never check a service's
legitimacy in the first place.  People who selected ``Other'' provided a wide
variety of ad-hoc phishing protections, some of which clearly misguided, further
highlighting the importance of this issue.

\begin{figure}[t]
    \centering
    \input{figures/determining-legitimacy.tex}
    \caption{How our respondents determine an onion service's legitimacy.}
    \label{fig:determining-legitimacy}
\end{figure}

Originally meant to provide ``branding'' for an onion service, vanity onion
domains also play a role in the context of phishing.  There is concern that the
short and recognizable prefixes tempt users to only verify the prefix and ignore
subsequent characters~\cite{Winter2015a}.  Quoting two of our survey responses:

\begin{displayquote}[Survey respondent]
I only memorize the first part of the domain.
\end{displayquote}

\begin{displayquote}[Survey respondent]
If there isn't some cognizable word at the start, it'll be more difficult for me
to determine if I'm going to the correct domain or a scam. I may end up going to
less .onion sites as a result.
\end{displayquote}

Focusing only on the vanity part of a domain allows attackers to create an
impersonation domain that features the original's prefix but differs in
subsequent characters.  Nurmi~\cite{Nurmi2015a} and
Monteiro~\cite{Monteiro2016a} have both documented such an attack but its
effectiveness is not known.

The majority of our respondents appreciates vanity domains because they are easy
to remember (64\%), easy to recognize (64\%), and they provide a unique
``branding'' (34\%).  Some respondents indicate that a vanity prefix---like a
traditional domain---informs about an onion service's content, letting visitors
know what to expect, and thus preventing bad surprises.  Only 8\% dislike vanity
onion domains and 15\% do not have an opinion.  Interestingly, some respondents
consider vanity domains economically unfair because wealthy entities can afford
to generate longer prefixes.  Several respondents also voiced their concern that
vanity domains create a false sense of security and facilitate phishing attacks.

In a separate question we inquired how many characters our respondents verify in
onion domains.  43\% verify thirteen to sixteen digits, \ie (almost) the full
domain, while 46\% verify up to nine digits, which is within the realm of brute
force attacks.  Finally, a handful of respondents cited misguided reasons why
they dislike vanity domains, \eg, some believe that vanity domains are a sign of
weak hash functions while others believe that vanity domains make the onion
service ``less hidden'' or allow somebody to create ``the same private key.''
